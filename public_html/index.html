<!doctype html>
<html lang="en">


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <!-- Favicon -->
    <link rel="icon" href="images/favicon/favicon.png" type="image/png" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="apple-touch-icon" sizes="any" href="images/favicon/favicon.png">
    <link rel="apple-touch-icon-precomposed" href="images/favicon/favicon.png">
    <link rel="mask-icon" href="images/favicon/favicon.png">

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Red Rose' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>

    <!-- Title -->
    <title>Play Nard Online</title>

    <!-- Styles -->
    <link rel="stylesheet" href="styles/start.css">
    <link rel="stylesheet" href="styles/game.css">

</head>
 

<body>
    <div id="board">
        
        <div id="horizontal">
            
            <div class="hint" id="hint"></div>
                
            <div id="diceBox">
                <div class=die id="die3" val=""></div>
                <div class=die id="die1" val=""></div>
                <div class=die id="die2" val=""></div>
                <div class=die id="die4" val=""></div>
            </div>
        
        </div>

        <div class="vertical">
            <div class="field top" id="24"></div>
            <div class="field bottom" id="1"></div>
        </div>

        <div class="vertical">
            <div class="field top" id="23"></div>
            <div class="field bottom" id="2"></div>
        </div>

        <div class="vertical">
            <div class="field top" id="22"></div>
            <div class="field bottom" id="3"></div>
        </div>

        <div class="vertical">
            <div class="field top" id="21"></div>
            <div class="field bottom" id="4"></div>
        </div>

        <div class="vertical">
            <div class="field top" id="20"></div>
            <div class="field bottom" id="5"></div>
        </div>

        <div class="vertical">
            <div class="field top" id="19"></div>
            <div class="field bottom" id="6"></div>
        </div>

        <div id="middle_side">
            <div class="buttons top">
                <svg class="button menu unactive hidden" width="36%" viewBox="0 0 90 90" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M70 25L20 25" stroke="black" stroke-width="12" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M69.9999 65H19.9999" stroke="black" stroke-width="12" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M69.9999 45L19.9999 45" stroke="black" stroke-width="12" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="field middle" id="0"></div>
            <div class="buttons bottom">
                
                <svg class="button return unactive" width="36%" viewBox="0 0 84 97" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M48.5535 13L13.1982 48.3553" stroke="#B8B7B7" stroke-width="12" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M48.5536 83.7109L13.1982 48.3556" stroke="#B8B7B7" stroke-width="12" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                    
            </div>
        </div>

        <div class="vertical">
            <div class="field top" id="18"></div>
            <div class="field bottom" id="7"></div>
        </div>

        <div class="vertical">
            <div class="field top" id="17"></div>
            <div class="field bottom" id="8"></div>
        </div>

        <div class="vertical">
            <div class="field top" id="16"></div>
            <div class="field bottom" id="9"></div>
        </div>

        <div class="vertical">
            <div class="field top" id="15"></div>
            <div class="field bottom" id="10"></div>
        </div>

        <div class="vertical">
            <div class="field top" id="14"></div>
            <div class="field bottom" id="11"></div>
        </div>

        <div class="vertical">
            <div class="field top" id="13"></div>
            <div class="field bottom" id="12"></div>
        </div>
    </div>


    <!-- START SCREEN -->
    <div id="start-back"></div>
    
    <!-- START MODAL -->
    <div id="start-modal">

        
        <!-- START MODAL HEADER-->
        <div id="start-header">
            <p>Welcome back!</p>
            <p id="greeting-small">We're so exited to see you again!</p>
        </div>

        <!-- Nard / Backgammon
        <div class="start-modal-row">
            <button id="game-nard" class="start option selected">nard</button>
            <button id="game-backgammon" class="start option" title="Sorry, this game is not ready yet.">backgammon</button>
        </div> -->

        <!-- Random / Friend -->
        <div class="start-modal-row">
            <button id="rival-random" class="start option selected">random rival</button>
            <button id="rival-friend" class="start option">friend</button>
        </div>

        <!-- START MODAL FOOTER-->
        <div class="start-modal-footer">
            
            <!-- Shown by default -->
            <button id="start-play-btn" class="start play show">play</button>

            <!-- Hidden by default, shown by PLAY button click -->
            <div id="start-await-random-rival">
                <div class="start await">
                    <span>Waiting for a rival...</span>
                </div>
                <p style="text-align: center;">The game will start as soon as a rival is found.</p>
            </div>

            <!-- Hidden by default, shown by FRIEND button click -->
            <div id="start-play-link">
                <div class="start link">
                    <span>
                        <!-- Here is the link for a friend -->
                        <input id="start-friends-link">
                    </span>
                    <svg id="copy-icon" viewBox="0 0 32 32"><g fill="none" fill-rule="evenodd"><path fill="#b9bbbe" fill-rule="nonzero" d="M4,8 L4,28 L24,28 L24,8 L4,8 Z M4,6 L24,6 C25.1045695,6 26,6.8954305 26,8 L26,28 C26,29.1045695 25.1045695,30 24,30 L4,30 C2.8954305,30 2,29.1045695 2,28 L2,8 C2,6.8954305 2.8954305,6 4,6 Z"/><path fill="#b9bbbe" fill-rule="nonzero" d="M8,6 L6,6 L6,4 C6,2.8954305 6.8954305,2 8,2 L28,2 C29.1045695,2 30,2.8954305 30,4 L30,24 C30,25.1045695 29.1045695,26 28,26 L26,26 L26,24 L28,24 L28,4 L8,4 L8,6 Z"/></g></svg>
                </div>
                <div>The game will start as soon as your friend visits this link.</div>
            </div>

        </div>
    </div>

    <!-- Socket.io -->
    <script src="/socket.io/socket.io.js"></script>
    
    <!-- My scripts -->
    <!-- Initiate global variables -->
    <script>
        // document.ontouchstart = (e) => {e.preventDefault()};
        // document.ontouchmove = (e) => {e.preventDefault()};
        // document.ontouchend = (e) => {e.preventDefault()};
        var dice;
        var board;
        var allowedSteps;
        var moves = [];    // all moves
        var stepsMade;    // part of the last move - steps that are made in this move

        var colorN;
        var color;

        // var dice;
        // var board;
        // var allowedSteps;
        // var moves = [];    // all moves
        // var stepsMade;    // part of the last move - steps that are made in this move


        // // Deprecated
        // var die1;
        // var die2;


    </script>
    <!-- Render the checkers -->
    <script>
        var isMoveFinished;
        var CHECKEROVERLAP = 5.5;

        // the board with a starting position
        board = {
            1: 15,
            2: 0,
            3: 0,
            4: 0,
            5: 0,
            6: 0,
            7: 0,
            8: 0,
            9: 0,
            10: 0,
            11: 0,
            12: 0,
            13: -15,
            14: 0,
            15: 0,
            16: 0,
            17: 0,
            18: 0,
            19: 0,
            20: 0,
            21: 0,
            22: 0,
            23: 0,
            24: 0
        };

        // Place one checker at certain field by id
        function createChecker(id, color) {
            let field = document.getElementById(id);
            let checker = document.createElement('checker');   // Create a checker
            checker.setAttribute('color', color);
            let checkersInField = field.children.length;
            if (field.classList.contains('top')) {
                checker.setAttribute('style', `top: calc(${checkersInField} * ${CHECKEROVERLAP}%);`);
            } else {
                checker.setAttribute('style', `bottom: calc(${checkersInField} * ${CHECKEROVERLAP}%);`);
            };
            field.appendChild(checker);    // Place checker inside the field
        };

        // Render checkers
        // function renderCheckers(board) {

        ////////////////////////////////////////////////////
        // for test
        // Clear all previous checkers
        for (let i = 0; i < 25; i++) {
            document.getElementById(i).innerHTML = '';    // clear the field
        };
        ////////////////////////////////////////////////////

        Object.entries(board).forEach((field) => {
            for (let i = 0; i < Math.abs(field[1]); i++) {
                createChecker(field[0], Math.sign(field[1]));
            };
        });
        // };
        // renderCheckers(board);

        var scroll = function(e) {
        // compute state
        if (stopScrollX || stopScrollY) {
            e.preventDefault();              // this one is the key
            e.stopPropagation();
            window.scroll(scrollToX, scrollToY);
        }
    }

    document.addEventListener('mousewheel', scroll, false);
    </script>


    <script src="src/utils.js"></script>
    <!-- type="module" -->
    <script  src="src/start-modal.js" defer></script> 
    <script  src="src/client.js" defer></script> 
    <script src="src/moving.js" defer></script>
    <script src="src/nardRules.js" defer></script>


</body>
</html>